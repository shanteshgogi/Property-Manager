# Property Manager Application

## Overview

A responsive Property Management System designed for landlords and property managers to track properties, units, tenants, rent payments, and expenses. The application provides a data-intensive, productivity-focused interface for managing rental properties with features including dashboards, transaction tracking, tenant management, and automated contract reminders.

**Primary Use Case**: Enable property managers to efficiently oversee multiple properties, track financial transactions, manage tenant relationships, and monitor occupancy rates through a clean, information-dense interface.

**Target Platform**: Web-first (desktop/tablet/mobile responsive), with future extensibility to mobile apps and iOS HTML wrappers.

## User Preferences

Preferred communication style: Simple, everyday language.

## System Architecture

### Frontend Architecture

**Framework Stack**: React + Vite + TypeScript with client-side routing via Wouter

**UI Component Library**: shadcn/ui (Radix UI primitives) with Tailwind CSS for styling
- **Rationale**: Provides accessible, customizable components following Material Design 3 principles adapted for data-dense applications
- **Design System**: Based on Linear's clean data presentation approach, prioritizing scanability and information density over visual flourish

**State Management**:
- **TanStack Query**: Server state management and data fetching with automatic caching and refetching
- **Zustand**: Planned for local UI state (e.g., selected property context)
- **React Hook Form + Zod**: Form validation and data schema enforcement

**Styling Approach**:
- **Typography**: Inter font family for UI, JetBrains Mono for financial/numerical data
- **Color System**: HSL-based theming with light/dark mode support via CSS variables
- **Spacing**: Consistent Tailwind units (2, 4, 6, 8) for predictable layouts
- **Responsive Design**: Mobile-first with breakpoints at 768px (md) and 1024px (lg)

### Backend Architecture

**Runtime**: Node.js with Express + TypeScript

**API Design**: RESTful endpoints with consistent error handling
- **Pattern**: Resource-based routes (`/api/properties`, `/api/units`, `/api/tenants`, `/api/transactions`)
- **Response Format**: JSON with structured error objects containing `code` and `message` fields
- **File Upload**: Multer middleware for handling tenant ID images and transaction receipts

**Validation Strategy**:
- **Zod Schemas**: Shared between client and server via `shared/schema.ts` for type safety
- **Drizzle-Zod Integration**: Auto-generated insert schemas from database models

**Logging & Monitoring**:
- Custom request logging middleware tracking method, path, status, duration
- Activity logging system for audit trails of entity changes

**Security Considerations**:
- Express middleware stack includes helmet, cors, rate limiting (mentioned in spec)
- File upload restrictions: Images only, 5MB max size
- Input validation via Zod on all API endpoints

### Data Storage & Schema

**Database**: PostgreSQL via Neon serverless with WebSocket connections

**ORM**: Drizzle ORM for type-safe database queries
- **Rationale**: Provides TypeScript-native SQL query builder with zero runtime overhead
- **Migration Strategy**: Schema-first approach with migrations in `./migrations` directory

**Core Schema Design**:

1. **Properties** - Top-level entities representing physical buildings
   - Fields: id (UUID), name, address, timestamps

2. **Units** - Individual rental spaces within properties
   - Fields: id, name, propertyId (FK), deposit, floor, rent, maintenance, contract dates
   - Relationship: Many units to one property (cascade delete)

3. **Tenants** - People renting units
   - Fields: id, status, name, unitId (FK nullable), contact info, demographics, KYC data
   - Relationship: Many tenants to one unit (set null on unit delete)
   - Features: Supports ID document uploads, emergency contacts, work details

4. **Transactions** - Financial records
   - Fields: id, name, type, isIncome boolean, amount (decimal), date, unitId (FK), receipt URL
   - Relationship: Many transactions to one unit (cascade delete)
   - Design: Single table for both income and expenses using `isIncome` discriminator

5. **Reminders** - Automated contract renewal alerts
   - Fields: id, unitId (FK), message, timestamps
   - Purpose: Generated by cron job for contracts expiring within 30 days

6. **Activity Logs** - Audit trail
   - Fields: id, entityType, entityId, action, message, timestamp
   - Purpose: Track all significant changes across entities

### Scheduled Jobs & Automation

**Cron Implementation**: node-cron for scheduled tasks

**Contract Renewal Checker**:
- **Schedule**: Daily at 9 AM
- **Logic**: Identifies units with contracts expiring within 30 days
- **Action**: Creates reminder entries if none exist for the unit
- **Rationale**: Proactive notification system to prevent contract lapses

### Search & Filter Architecture

**Implementation**: Client-side filtering with server-side data fetching
- **Search**: Multi-field text matching (tenant name, phone, email, unit name, transaction type)
- **Filters**: Property-based, status-based (Active/Inactive), date range, income/expense type
- **UI Components**: Dedicated SearchBar and FilterPanel components with clear/reset functionality

### File Management

**Upload Directory**: `/uploads` served statically with CORS enabled

**Supported Files**:
- Tenant ID documents (images only)
- Transaction receipts (images only)

**Storage**: Local filesystem with unique UUID-based filenames to prevent collisions

### Export Functionality

**Format**: CSV generation via custom utility function

**Features**:
- Escaping of special characters (commas, quotes, newlines)
- Tenant export with status filtering
- Transaction export with date range filtering

## External Dependencies

**Database Provider**: Neon Serverless PostgreSQL
- WebSocket-based connection pooling
- Managed PostgreSQL with auto-scaling

**UI Component Libraries**:
- **Radix UI**: Accessible primitives for dialogs, dropdowns, popovers, etc.
- **Recharts**: Chart visualization for income/expense trends
- **Lucide React**: Icon system

**Development Tools**:
- **Vite**: Build tool and dev server with HMR
- **esbuild**: Production server bundling
- **tsx**: TypeScript execution for development

**Fonts**: Google Fonts CDN for Inter and JetBrains Mono

**Validation & Forms**:
- **Zod**: Runtime type validation
- **React Hook Form**: Form state management
- **@hookform/resolvers**: Zod integration for React Hook Form

**Date Handling**: date-fns for date manipulation and formatting

**Session Management**: connect-pg-simple for PostgreSQL-backed sessions (dependency present, implementation pending)